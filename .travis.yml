language: python
fast_finish: true

python:
  - 3.5
  - 3.6

os:
  - linux
  - osx

group: travis_latest

git:
  depth: 3

before_install:
  - if [[ $TRAVIS_OS_NAME == osx ]]; then
    wget https://repo.continuum.io/miniconda/Miniconda3-latest-MacOSX-x86_64.sh -O miniconda.sh;

    bash miniconda.sh -b -p $HOME/miniconda;
    export PATH=$HOME/miniconda/bin:$PATH;
    hash -r;
    
    conda config --set always_yes yes --set changeps1 no;
    conda update -q conda;
    conda create -n test python=$TRAVIS_PYTHON_VERSION;
    source activate test;
    fi
    
  - if [[ $TRAVIS_OS_NAME == osx ]]; then
    brew update > /dev/null;
    brew install ffmpeg;
    fi

install: pip -q install -e .[tests]

script:
  - pytest -v

after_success:
  - if [[ $TRAVIS_PYTHON_VERSION == 3.6* ]]; then 
    coverage run tests/test_all.py;
    coveralls; 
    fi

